    Sub AgruparESomarEntradasSaidas()
        Dim ws As Worksheet
        Set ws = ThisWorkbook.Sheets("NomeDaSuaAba") ' Troque para o nome da aba onde estão os dados
    
        Dim resumoWs As Worksheet
        Set resumoWs = ThisWorkbook.Sheets("Resumo") ' Define a aba "Resumo" como destino dos resultados
    
        Dim lastRow As Long
        lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row ' Última linha com dados na aba original
    
        Dim dictEntrada As Object
        Set dictEntrada = CreateObject("Scripting.Dictionary")
    
        Dim dictSaida As Object
        Set dictSaida = CreateObject("Scripting.Dictionary")
    
        Dim i As Long, chave As Variant, valor As Double
    
        ' Percorrer as linhas e fazer a contagem
        For i = 2 To lastRow ' Começar da linha 2 para ignorar o cabeçalho
            chave = ws.Cells(i, 7).Value ' Coluna 7 (G), a chave do agrupamento
            valor = ws.Cells(i, 3).Value ' Coluna 3 (C), o valor a ser somado
    
            If ws.Cells(i, 1).Value = "Entrada" Then
                If dictEntrada.exists(chave) Then
                    dictEntrada(chave) = dictEntrada(chave) + valor
                Else
                    dictEntrada.Add chave, valor
                End If
            ElseIf ws.Cells(i, 1).Value = "Saída" Then
                If dictSaida.exists(chave) Then
                    dictSaida(chave) = dictSaida(chave) + valor
                Else
                    dictSaida.Add chave, valor
                End If
            End If
        Next i
    
        ' Limpa a aba "Resumo" para os novos resultados
        resumoWs.Cells.Clear
    
        ' Exibir resultados para Entradas na aba "Resumo"
        Dim linhaResultado As Long
        linhaResultado = 2
        resumoWs.Cells(1, 1).Value = "Agrupamento - Entrada"
        resumoWs.Cells(1, 7).Value = "Chave"
        resumoWs.Cells(1, 8).Value = "Soma"
    
        For Each chave In dictEntrada.keys
            resumoWs.Cells(linhaResultado, 7).Value = chave
            resumoWs.Cells(linhaResultado, 8).Value = dictEntrada(chave)
            linhaResultado = linhaResultado + 1
        Next chave
    
        ' Exibir resultados para Saídas na aba "Resumo"
        linhaResultado = linhaResultado + 2
        resumoWs.Cells(linhaResultado, 1).Value = "Agrupamento - Saída"
        resumoWs.Cells(linhaResultado, 7).Value = "Chave"
        resumoWs.Cells(linhaResultado, 8).Value = "Soma"
        linhaResultado = linhaResultado + 1
    
        For Each chave In dictSaida.keys
            resumoWs.Cells(linhaResultado, 7).Value = chave
            resumoWs.Cells(linhaResultado, 8).Value = dictSaida(chave)
            linhaResultado = linhaResultado + 1
        Next chave
    
        MsgBox "Processo concluído! Resultados na aba 'Resumo'."
    End Sub
